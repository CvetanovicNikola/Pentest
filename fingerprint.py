import nmap
import sys
import pprint
import time

scan = nmap.PortScanner()

print("\nThe scanner is running...\n")

scanner = scan.scan(sys.argv[1], "80", arguments="-O")


host_is_up = f"The host is {scanner['scan'][sys.argv[1]]['status']['state']}\n"
port_open = f"The port 80 is {scanner['scan'][sys.argv[1]]['tcp'][80]['state']}\n"
method_scan = f"The method of scanning is {scanner['scan'][sys.argv[1]]['tcp'][80]['reason']}\n"
guess_os = f"There is a {scanner['scan'][sys.argv[1]]['osmatch'][0]['accuracy']} that the host is running {scanner['scan'][sys.argv[1]]['osmatch'][0]['name']}\n"

with open(f"{sys.argv[1]}.txt", "w") as f:
    f.write(host_is_up + port_open + method_scan + guess_os)
    f.write(
        f"\nReport generated : {time.strftime('%Y-%m-%d_%H:%M:%S GMT', time.gmtime())}")

print("\nFinshed!")

""" pp = pprint.PrettyPrinter()
pp.pprint(scanner)
 """